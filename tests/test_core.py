# coding: utf-8

# PACKAGES
import os
import sys
import inspect
currentdir = os.path.dirname(os.path.abspath(inspect.getfile(inspect.currentframe())))
parentdir = os.path.dirname(currentdir)
sys.path.insert(0, parentdir)
import numpy as np

# MODULES
from list_compare import list_of_lists_compare
from core import UnitsConvertor


def test_same_unit_ascending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    ascending_order = True
    # expected result
    expected_result = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                                 35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                                [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                                 35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                                [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                                 35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                                [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                                 35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                                [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                                 100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    # assert
    unit_list = ["cm-1", "micron", "nm", "A"]
    for unit in unit_list:
        convert_action = UnitsConvertor(data_array, unit, unit, ascending_order)
        convert_action.convert_units()
        assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_same_unit_descending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    ascending_order = False
    # expected result
    expected_result = np.array([[5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                                 100.000000, 1000.000000, 898.973733, 0.000000, 0.000000],
                                [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                                 35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                                [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                                 35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                                [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                                 35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                                [1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                                 35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000]])
    # assert
    unit_list = ["cm-1", "micron", "nm", "A"]
    for unit in unit_list:
        convert_action = UnitsConvertor(data_array, unit, unit, ascending_order)
        convert_action.convert_units()
        assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_cm_micron_micron_cm_descending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "cm-1"
    unit_to = "micron"
    ascending_order = False
    # expected result
    expected_result = np.array(
        [[10, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
         [5, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [3.3333333333333333, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [2.5, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [2, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)
    # assert
    convert_action = UnitsConvertor(data_array, unit_to, unit_from, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_cm_micron_micron_cm_ascending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "cm-1"
    unit_to = "micron"
    ascending_order = True
    # expected result
    expected_result = np.array(
        [[2, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000],
         [2.5, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [3.3333333333333333, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [5, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [10, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)
    # assert
    convert_action = UnitsConvertor(data_array, unit_to, unit_from, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_cm_nm_nm_cm_descending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "cm-1"
    unit_to = "nm"
    ascending_order = False
    # expected result
    expected_result = np.array(
        [[10000000 / 1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
         [10000000 / 2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [10000000 / 3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [10000000 / 4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [10000000 / 5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)
    # assert
    convert_action = UnitsConvertor(data_array, unit_to, unit_from, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_cm_nm_nm_cm_ascending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "cm-1"
    unit_to = "nm"
    ascending_order = True
    # expected result
    expected_result = np.array(
        [[10000000 / 5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000],
         [10000000 / 4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [10000000 / 3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [10000000 / 2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [10000000 / 1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
         35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)
    # assert
    convert_action = UnitsConvertor(data_array, unit_to, unit_from, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_cm_A_A_cm_descending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "cm-1"
    unit_to = "A"
    ascending_order = False
    # expected result
    expected_result = np.array(
        [[100000000 / 1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
         [100000000 / 2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [100000000 / 3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [100000000 / 4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [100000000 / 5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)
    # assert
    convert_action = UnitsConvertor(data_array, unit_to, unit_from, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_cm_A_A_cm_ascending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "cm-1"
    unit_to = "A"
    ascending_order = True
    # expected result
    expected_result = np.array(
        [[100000000 / 5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000],
         [100000000 / 4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [100000000 / 3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [100000000 / 2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [100000000 / 1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
         35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)
    # assert
    convert_action = UnitsConvertor(data_array, unit_to, unit_from, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_micron_nm_ascending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "micron"
    unit_to = "nm"
    ascending_order = True
    # expected result
    expected_result = np.array(
        [[1000 * 1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
         [1000 * 2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [1000 * 3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [1000 * 4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [1000 * 5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_micron_nm_descending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "micron"
    unit_to = "nm"
    ascending_order = False
    # expected result
    expected_result = np.array(
        [[1000 * 5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000],
         [1000 * 4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [1000 * 3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [1000 * 2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [1000 * 1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_nm_micron_ascending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "nm"
    unit_to = "micron"
    ascending_order = True
    # expected result
    expected_result = np.array(
        [[1000.000000 / 1000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
         [2000.000000 / 1000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [3000.000000 / 1000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [4000.000000 / 1000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [5000.000000 / 1000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_nm_micron_descending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "nm"
    unit_to = "micron"
    ascending_order = False
    # expected result
    expected_result = np.array(
        [[5.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000],
         [4.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [3.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [2.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [1.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_A_micron_ascending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "A"
    unit_to = "micron"
    ascending_order = True
    # expected result
    expected_result = np.array(
        [[1000.000000 / 10000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
         [2000.000000 / 10000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [3000.000000 / 10000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [4000.000000 / 10000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [5000.000000 / 10000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_A_micron_descending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "A"
    unit_to = "micron"
    ascending_order = False
    # expected result
    expected_result = np.array(
        [[5000.000000 / 10000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000],
         [4000.000000 / 10000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [3000.000000 / 10000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [2000.000000 / 10000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [1000.000000 / 10000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
         35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_micron_A_ascending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "micron"
    unit_to = "A"
    ascending_order = True
    # expected result
    expected_result = np.array(
        [[10000 * 1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
         [10000 * 2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [10000 * 3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [10000 * 4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [10000 * 5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_micron_A_descending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "micron"
    unit_to = "A"
    ascending_order = False
    # expected result
    expected_result = np.array(
        [[10000 * 5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000],
         [10000 * 4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [10000 * 3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [10000 * 2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [10000 * 1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_nm_A_ascending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "nm"
    unit_to = "A"
    ascending_order = True
    # expected result
    expected_result = np.array(
        [[10 * 1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
         [10 * 2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [10 * 3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [10 * 4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [10 * 5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_nm_A_descending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "nm"
    unit_to = "A"
    ascending_order = False
    # expected result
    expected_result = np.array(
        [[10 * 5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000],
         [10 *  4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [10 * 3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [10 *  2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [10 *  1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_A_nm_ascending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "A"
    unit_to = "nm"
    ascending_order = True
    # expected result
    expected_result = np.array(
        [[1000.000000 / 10, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
         [2000.000000 / 10, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [3000.000000 / 10, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [4000.000000 / 10, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [5000.000000 / 10, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def test_A_nm_descending():
    # input
    data_array = np.array([[1000.000000, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
                            35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000],
                           [2000.000000, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
                            35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
                           [3000.000000, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
                            35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
                           [4000.000000, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
                            35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
                           [5000.000000, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
                            100.000000, 1000.000000, 898.973733, 0.000000, 0.000000]])
    unit_from = "A"
    unit_to = "nm"
    ascending_order = False
    # expected result
    expected_result = np.array(
        [[5000.000000 / 10, 0.002913, 0.001491, 0.053155, 0.057989, 1.954467, 15.346796, 1000.000000,
          100.000000, 1000.000000, 898.973733, 0.000000, 0.000000],
         [4000.000000 / 10, 0.019943, 0.002312, 0.030155, 0.001532, 8.624264, 15.454073, 1000.000000,
          35.000000, 10000.000000, 781.503750, 0.000000, 0.000000],
         [3000.000000 / 10, 0.049520, 0.001497, 0.032695, 0.000530, 33.081305, 15.534905, 1000.000000,
          35.000000, 100000.000000, 658.861883, 0.000000, 0.000000],
         [2000.000000 / 10, 0.678184, 0.001913, 0.410710, 0.000671, 354.525122, 7.726905, 1000.000000,
          35.000000, 3000000.000000, 434.109033, 0.000000, 0.000000],
         [1000.000000 / 10, 0.705083, 0.002189, 0.849915, 0.001760, 322.094034, 3.863321, 1000.000000,
          35.000000, 3000000.000000, 188.767883, 0.000000, 0.000000]])
    # assert
    convert_action = UnitsConvertor(data_array, unit_from, unit_to, ascending_order)
    convert_action.convert_units()
    assert list_of_lists_compare(convert_action.get_converted_data(), expected_result, 10 ** -15)

def end_f():
    pass
